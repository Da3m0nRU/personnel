# АИС "Кадры" (Автоматизированная Информационная Система Учета Кадров)

![Python Version](https://img.shields.io/badge/python-3.9%2B-blue.svg)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

АИС "Кадры" - это десктопное приложение на Python с использованием CustomTkinter для автоматизации процессов ведения кадрового учета на предприятии. Оно предназначено для сотрудников отдела кадров и администраторов системы.

## Основные Возможности

- **Управление данными сотрудников:** Добавление, редактирование и просмотр информации о сотрудниках.
- **Учет кадровых событий:** Регистрация приема на работу, увольнения, перемещения (перевода). События автоматически создаются при изменении статуса, должности или отдела сотрудника.
- **Учет отсутствий:** Добавление, редактирование и просмотр записей об отсутствиях сотрудников (полный/неполный день).
- **Дашборд:** Визуальное представление ключевых кадровых показателей (общее число сотрудников, динамика приема/увольнений, распределение по отделам, должностям, возрасту и полу).
- **Формирование отчетов:** Создание отчетов по уволенным сотрудникам и по суммарному времени отсутствия с визуализацией (графики) и табличным представлением.
- **Импорт данных:** Загрузка данных о сотрудниках, отсутствиях и пользователях из файлов CSV и XML с использованием механизма Drag & Drop.
- **Экспорт данных:** Выгрузка данных о сотрудниках, кадровых событиях, отсутствиях и пользователях в форматах CSV и XML.
- **Управление пользователями:** (Только для Администратора) Создание, редактирование и удаление учетных записей пользователей системы, управление ролями и связью с сотрудниками.
- **Ролевая модель доступа:** Разграничение прав доступа для ролей "Администратор" и "Кадровик" ("Сотрудник отдела кадров").
- **Безопасность:** Аутентификация пользователей по логину/паролю, хранение паролей в хешированном виде (bcrypt).
- **Логирование:** Ведение журнала событий и ошибок в файл `app.log`.

## Технологии

- **Язык:** Python 3.9+
- **GUI:** CustomTkinter (+ TkinterDnD2 для Drag&Drop)
- **База данных:** SQLite 3
- **Визуализация:** Matplotlib
- **Таблицы:** tksheet
- **Работа с данными:** `csv`, `xml.etree.ElementTree`, `datetime`, `re`, `codecs`
- **Безопасность:** `bcrypt`
- **Прочее:** `Pillow` (изображения), `python-dotenv` (конфигурация)

## Установка и запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <url-вашего-репозитория>
    cd <папка-репозитория>
    ```
2.  **Создайте и активируйте виртуальное окружение:**
    ```bash
    install_requirements.bat
    ```
3.  **Запустите приложение:**
    ```bash
    python main.py
    ```
    - **Важно:** При первом запуске база данных будет пустой. Вам потребуется создать первого пользователя (Администратора) либо вручную через утилиту SQLite, либо модифицировать код `main.py` для создания администратора по умолчанию, если база данных пуста и не содержит пользователей.

## Использование

1.  **Вход:** Используйте логин и пароль для входа.
2.  **Навигация:** Используйте панель слева для доступа к разделам: "Главная", "Сотрудники", "События", "Отсутствия", "Отчеты", "Пользователи" (последняя доступна только Администратору).
3.  **Работа:** В каждом разделе используйте кнопки ("Новая запись", "Изменить", "Удалить", "Импорт", "Экспорт", "Сформировать") для выполнения соответствующих действий.
4.  **Таблицы:** Для просмотра данных используйте прокрутку и пагинацию (`<`, `>`) внизу таблиц. Используйте поле поиска над таблицей для фильтрации.
5.  **Импорт:** Откройте диалог импорта и перетащите на него файлы CSV или XML нужного формата.
6.  **Отчеты:** Выберите тип отчета, задайте период и нажмите "Сформировать". Просматривайте результат на вкладках "График" и "Таблица". Нажмите "Экспорт" для сохранения данных текущей активной вкладки отчета.

## Автор

- **Разработчик:** Блинов Виктор Русланович
- **Группа:** ИТБ(б)-О-22/1
- **Учреждение:** Одинцовский филиал МГИМО МИД РФ
- **Проект по дисциплине:** "Программный проект"
